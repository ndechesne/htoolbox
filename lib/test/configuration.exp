
Test: client configuration
Syntax:
  expire, occ.: optional, max = 1; params: min = max = 1
  filter, occ.: optional, no max; params: min = max = 2
    condition, occ.: min = 1, no max; params: min = max = 2
  ignore, occ.: optional, max = 1; params: min = max = 1
  path, occ.: min = 1, no max; params: min = max = 1
    compress, occ.: optional, max = 1; params: min = max = 1
    filter, occ.: optional, no max; params: min = max = 2
      condition, occ.: min = 1, no max; params: min = max = 2
    ignore, occ.: optional, max = 1; params: min = max = 1
    no_compress, occ.: optional, max = 1; params: min = max = 1
    parser, occ.: optional, no max; params: min = 1, max = 2
  users, occ.: optional, max = 1; params: min = 1, no max
Error: after line: 0: missing keyword 'path'
Error: at line: 5: found CR character, aborting
Config:
2:   filter and subdir
3:     condition path_start subdir
4:     condition !size< 100
6:   users biloute machin
8:   ignore backup
10:   filter and bigfile
11:     condition size>= 10
12:     condition type file
14:   expire 1
16:   path test2//
18:   path test1
20:     filter and not_object
21:       condition !path_end .o
23:     filter or to_be_ignored
24:       condition filter subdir
25:       condition !filter not_object
27:     ignore to_be_ignored
29:     compress bigfile
31:     parser cvs controlled
32:     parser svn modified
34:     filter and cvs_entries
35:       condition name Entries
37:     no_compress cvs_entries
Test: server configuration
Syntax:
  client, occ.: min = 1, no max; params: min = 1, max = 2
    config, occ.: optional, max = 1; params: min = max = 1
    expire, occ.: optional, max = 1; params: min = max = 1
    filter, occ.: optional, no max; params: min = max = 2
      condition, occ.: min = 1, no max; params: min = max = 2
    hostname, occ.: optional, max = 1; params: min = max = 1
    ignore, occ.: optional, max = 1; params: min = max = 1
    option, occ.: optional, no max; params: min = 1, max = 2
    path, occ.: optional, no max; params: min = max = 1
      compress, occ.: optional, max = 1; params: min = max = 1
      filter, occ.: optional, no max; params: min = max = 2
        condition, occ.: min = 1, no max; params: min = max = 2
      ignore, occ.: optional, max = 1; params: min = max = 1
      no_compress, occ.: optional, max = 1; params: min = max = 1
      parser, occ.: optional, no max; params: min = 1, max = 2
    protocol, occ.: min = 1, max = 1; params: min = max = 1
    report_copy_error_once, occ.: optional, max = 1; params: min = max = 0
    timeout_nowarning, occ.: optional, max = 1; params: min = max = 0
    users, occ.: optional, max = 1; params: min = 1, no max
  db, occ.: optional, max = 1; params: min = max = 1
    compress, occ.: optional, max = 1; params: min = max = 1
    compress_auto, occ.: optional, max = 1; params: min = max = 0
  filter, occ.: optional, no max; params: min = max = 2
    condition, occ.: min = 1, no max; params: min = max = 2
  ignore, occ.: optional, max = 1; params: min = max = 1
  log, occ.: optional, max = 1; params: min = max = 1
    backups, occ.: optional, max = 1; params: min = max = 1
    max_lines, occ.: optional, max = 1; params: min = max = 1
  report_copy_error_once, occ.: optional, max = 1; params: min = max = 0
  timeout_nowarning, occ.: optional, max = 1; params: min = max = 0
Config:
1:   log hbackup.log
2:     max_lines 100000
3:     backups 10
4:   db test_db
5:     compress auto
7:     compress_auto
9:   filter all nothing
10:     condition type pipe
11:     condition size> 10
13:   ignore nothing
15:   filter all backup
16:     condition type file
17:     condition path_end ~
19:   filter any test_or
20:     condition filter backup
21:     condition !size< 1000
23:   client myClient xp
24:     protocol smb
25:     users backup
26:     config C:\Backup\Backup.LST
28:   client myClient
29:     protocol nfs
30:     users backup root
31:     hostname myClient
32:     config /home/User/hbackup.list
34:   client newClient
35:     protocol ssh
36:     option username user
37:     option password p4sS?
38:     config /home/Blah/hbackup.list
40:   client other
41:     protocol none
42:     hostname otherClient
43:     option username foo
44:     option password bar
45:     config /home/Blah/hbackup.list
47:     filter and subdir
48:       condition path_start subdir
49:       condition !size< 100
51:     filter and bigfile
52:       condition size>= 10
53:       condition type file
55:     expire 1
57:     path test2//
59:     path test1
61:       filter and not_object
62:         condition !path_end .o
64:       filter or to_be_ignored
65:         condition filter subdir
66:         condition filter backup
67:         condition !filter not_object
69:       ignore to_be_ignored
71:       compress bigfile
73:       parser cvs controlled
74:       parser svn modified
76:   client myhost
77:     report_copy_error_once
78:     protocol file
79:     hostname myhost.mynetwork.lan
80:     timeout_nowarning
81:     config etc/localhost.list
82:     expire 1
84:   client client xp
85:     ignore backup
86:     protocol smb
87:     option username Myself
88:     option password flesyM
89:     option nocase
90:     hostname myClient
91:     config C:\Backup\Backup.LST
93:   client aClient vista
94:     protocol smb
95:     filter and huge_file
96:       condition !filter backup
97:       condition !size< 100
99:     path C:\Test Dir
100:       filter and compress_m
101:         condition !filter huge_file
102:       compress compress_m
103:       ignore backup
104:       parser svn modified
105:     report_copy_error_once
Test: configuration save
Config:
1:   log hbackup.log
2:     max_lines 100000
3:     backups 10
4:   db test_db
5:     compress auto
6:     compress_auto
7:   filter all nothing
8:     condition type pipe
9:     condition size> 10
10:   ignore nothing
11:   filter all backup
12:     condition type file
13:     condition path_end ~
14:   filter any test_or
15:     condition filter backup
16:     condition !size< 1000
17:   client myClient xp
18:     protocol smb
19:     users backup
20:     config C:\Backup\Backup.LST
21:   client myClient
22:     protocol nfs
23:     users backup root
24:     hostname myClient
25:     config /home/User/hbackup.list
26:   client newClient
27:     protocol ssh
28:     option username user
29:     option password p4sS?
30:     config /home/Blah/hbackup.list
31:   client other
32:     protocol none
33:     hostname otherClient
34:     option username foo
35:     option password bar
36:     config /home/Blah/hbackup.list
37:     filter and subdir
38:       condition path_start subdir
39:       condition !size< 100
40:     filter and bigfile
41:       condition size>= 10
42:       condition type file
43:     expire 1
44:     path test2//
45:     path test1
46:       filter and not_object
47:         condition !path_end .o
48:       filter or to_be_ignored
49:         condition filter subdir
50:         condition filter backup
51:         condition !filter not_object
52:       ignore to_be_ignored
53:       compress bigfile
54:       parser cvs controlled
55:       parser svn modified
56:   client myhost
57:     report_copy_error_once
58:     protocol file
59:     hostname myhost.mynetwork.lan
60:     timeout_nowarning
61:     config etc/localhost.list
62:     expire 1
63:   client client xp
64:     ignore backup
65:     protocol smb
66:     option username Myself
67:     option password flesyM
68:     option nocase
69:     hostname myClient
70:     config C:\Backup\Backup.LST
71:   client aClient vista
72:     protocol smb
73:     filter and huge_file
74:       condition !filter backup
75:       condition !size< 100
76:     path C:\Test Dir
77:       filter and compress_m
78:         condition !filter huge_file
79:       compress compress_m
80:       ignore backup
81:       parser svn modified
82:     report_copy_error_once
Test: broken configuration
Error: after line: 0: need at most 1 occurence(s) of keyword 'db'
Error: after line: 0: need at most 1 occurence(s) of keyword 'report_copy_error_once'
Error: after line: 0: need at most 1 occurence(s) of keyword 'timeout_nowarning'
Error: at line: 10: keyword 'filter' requires 2 parameter(s), found 1
Error: after line: 14: missing keyword 'condition'
Error: after line: 16: need at most 1 occurence(s) of keyword 'ignore'
Error: at line: 18: keyword 'users' requires at least 1 parameter(s), found 0
Error: at line: 20: keyword 'ignore' requires 1 parameter(s), found 0
Error: after line: 22: need at most 1 occurence(s) of keyword 'config'
Error: after line: 22: need at most 1 occurence(s) of keyword 'expire'
Error: after line: 22: need at most 1 occurence(s) of keyword 'hostname'
Error: at line: 26: keyword 'option' requires at most 2 parameter(s), found 3
Error: at line: 27: keyword 'option' requires at least 1 parameter(s), found 0
Error: at line: 35: keyword 'filter' requires 2 parameter(s), found 3
Error: at line: 36: keyword 'condition' requires 2 parameter(s), found 3
Error: at line: 37: keyword 'condition' requires 2 parameter(s), found 1
Error: at line: 40: keyword 'expire' requires 1 parameter(s), found 2
Error: after line: 44: need at most 1 occurence(s) of keyword 'compress'
Error: after line: 44: need at most 1 occurence(s) of keyword 'ignore'
Error: after line: 54: missing keyword 'condition'
Error: at line: 56: keyword 'filter' requires 2 parameter(s), found 1
Error: after line: 56: missing keyword 'condition'
Error: after line: 68: missing keyword 'protocol'
Error: at line: 74: keyword 'ignore' requires 1 parameter(s), found 2
Error: at line: 75: keyword 'compress' requires 1 parameter(s), found 2
Error: at line: 88: keyword 'ignore' requires 1 parameter(s), found 0
Error: at line: 89: keyword 'compress' requires 1 parameter(s), found 0
Error: at line: 91: keyword 'what_the_f...?' incorrect or misplaced, aborting
Config:
1:   db test_db
2:   db blah
4:   timeout_nowarning
5:   timeout_nowarning
7:   report_copy_error_once
8:   report_copy_error_once
10:   filter all
11:     condition type file
12:     condition path_end ~
14:   filter any test_or
16:   client myClient
17:     protocol nfs
18:     users
19:     ignore test_or
20:     ignore
22:   client other
23:     protocol ssh
24:     hostname otherClient
25:     hostname 192.168.0.132
26:     option I am happy
27:     option
28:     config /home/backup/Backup.list
29:     config /home/backup/Backup2.list
31:     filter and subdir
32:       condition path_start subdir
33:       condition !size< 100
35:     filter and bigfile 3
36:       condition size>= 10 yeah
37:       condition type
39:     expire 1
40:     expire 2 3
42:     path test2//
44:     path test1
46:       filter and not_object
47:         condition !path_end .o
49:       filter or to_be_ignored
50:         condition filter subdir
51:         condition filter backup
52:         condition !filter not_object
54:       filter and blah
56:       filter or
59:       ignore to_be_ignored
60:       ignore to_be_ignored2
62:       compress bigfile
63:       compress bigfile2
65:       parser cvs controlled
66:       parser svn modified
68:   client myhost
69:     hostname myhost.mynetwork.lan
70:     config etc/localhost.list
71:     expire 1
73:     path blah
74:       ignore 2 3
75:       compress 4 5
77:   client client xp
78:     protocol smb
79:     option username Myself
80:     option password flesyM
81:     option nocase
82:     hostname myClient
83:     config C:\Backup\Backup.LST
85:     path C:\Crash"
86:     path C:\Crash
87:     path blah
88:       ignore
89:       compress
