db::open status 1

Test: getdir
Check test_db/data dir: 0
febatest1 status: 0, getdir_path: test_db/data/fe/ba/test1
fe98test2 status: 0, getdir_path: test_db/data/fe/98/test2
fe98test3 status: 1, getdir_path: test_db/data/fe/98/test3
fetest4 status: 1, getdir_path: test_db/data/fe/te/st4
fedc76test5 status: 1, getdir_path: test_db/data/fe/dc/76/test5
fedc76test6 status: 1, getdir_path: test_db/data/fe/dc/76/test6
fedc76test6 status: 0, getdir_path: test_db/data/fe/dc/76/test6

Test: write and read back with no compression (auto)
Checking data, sizes: f=13 z=33 (33)
Adding uncompressed data for 59ca0efa9f5633cb0371bbc0355478d8-0
59ca0efa9f5633cb0371bbc0355478d8-0  test1/testfile
Meta file contents: 
13	.
59ca0efa9f5633cb0371bbc0355478d8-0 13\r
59ca0efa9f5633cb0371bbc0355478d8-0  test_db/blah

Test: write and read back with compression (auto)
Checking data, sizes: f=10485760 z=10208 (10367)
Adding compressed data for f1c9645dbc14efddc7d8a322685f26eb-0
f1c9645dbc14efddc7d8a322685f26eb-0  test1/big_file
Meta file contents: 
10485760	+
f1c9645dbc14efddc7d8a322685f26eb-0 10485760 10208\r
f1c9645dbc14efddc7d8a322685f26eb-0  test_db/blah

Test: write and read back with forbidden compression
59ca0efa9f5633cb0371bbc0355478d8-0  test1/testfile
Meta file contents: 
13	-
59ca0efa9f5633cb0371bbc0355478d8-0 13            \r
59ca0efa9f5633cb0371bbc0355478d8-0  test_db/blah

Test: write and read back with forced compression
Adding compressed data for 59ca0efa9f5633cb0371bbc0355478d8-0
59ca0efa9f5633cb0371bbc0355478d8-0  test1/testfile
Meta file contents: 
13	f
Error: No such file or directory opening metadata file 'test_db/data/59/ca0efa9f5633cb0371bbc0355478d8-0/meta'
Warning: Adding missing metadata for 59ca0efa9f5633cb0371bbc0355478d8-0
59ca0efa9f5633cb0371bbc0355478d8-0 13 33\r
Size reported: 13
Meta file contents: 
13	 
59ca0efa9f5633cb0371bbc0355478d8-0 13 33\r
Replacing with uncompressed data for 59ca0efa9f5633cb0371bbc0355478d8-0
59ca0efa9f5633cb0371bbc0355478d8-0  test_db/blah

Test: organise
Lesser:
test_db/data/zz:
000001

test_db/data/zz/000001:
Equal:
test_db/data/zz:
00
.nofiles

test_db/data/zz/00:
0001
0002

test_db/data/zz/00/0001:

test_db/data/zz/00/0002:
Greater:
test_db/data/zz:
00
.nofiles

test_db/data/zz/00:
00
.nofiles

test_db/data/zz/00/00:
01
02
03

test_db/data/zz/00/00/01:

test_db/data/zz/00/00/02:

test_db/data/zz/00/00/03:

Test: read-only mode

Test: do nothing

Test: scan - metadata check/correct
 * missing
Warning: Adding missing metadata for 59ca0efa9f5633cb0371bbc0355478d8-0
59ca0efa9f5633cb0371bbc0355478d8-0 13 38\r
 * check
59ca0efa9f5633cb0371bbc0355478d8-0 13 38\r
 * missing
Warning: Setting missing metadata for d41d8cd98f00b204e9800998ecf8427e
d41d8cd98f00b204e9800998ecf8427e 0\r
 * check
d41d8cd98f00b204e9800998ecf8427e 0\r

Test: check - metadata check/correct
 * missing
Warning: Adding missing metadata for 59ca0efa9f5633cb0371bbc0355478d8-0
59ca0efa9f5633cb0371bbc0355478d8-0 13 38\r
 * wrong
Error: Correcting wrong metadata for 59ca0efa9f5633cb0371bbc0355478d8-0
59ca0efa9f5633cb0371bbc0355478d8-0 13 38\r
 * check
59ca0efa9f5633cb0371bbc0355478d8-0 13 38\r
 * missing
Warning: Adding missing metadata for d41d8cd98f00b204e9800998ecf8427e
d41d8cd98f00b204e9800998ecf8427e 0\r
 * wrong
Error: Correcting wrong metadata for d41d8cd98f00b204e9800998ecf8427e
d41d8cd98f00b204e9800998ecf8427e 0\r
 * check
d41d8cd98f00b204e9800998ecf8427e 0\r
