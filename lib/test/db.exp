Backup::Backup(test_db/.backup)
Error: Cannot initialize in read-only mode
db::open error status -1
Error: Given DB path does not exist 'test_db'
db::open error status -1
Error: Given DB path does not exist 'test_db'
db::open error status -1
Error: Given DB path does not contain a database 'test_db'
db::open error status -1
Error: Given DB path does not contain a database 'test_db'
See help for information on how to initialize the DB
db::open error status -1
Database initialized in 'test_db'
Database open in read/write mode

Test: scan & check
Sorting list
List contains 0 checksum(s)
List contains 0 unique checksum(s)
Crawling through DB
Found 0 valid and 0 broken data file(s)
Database closed
Database open in read/write mode
File data gone
Sorting list
List contains 0 checksum(s)
List contains 0 unique checksum(s)
Crawling through DB
Error: Data missing for 59ca0efa9f5633cb0371bbc0355478d8-0
Backup::removeHash(59ca0efa9f5633cb0371bbc0355478d8-0)
Found 0 valid and 1 broken data file(s)
Database closed
Database open in read/write mode
File data corrupted, surficial scan
Sorting list
List contains 0 checksum(s)
List contains 0 unique checksum(s)
Crawling through DB
59ca0efa9f5633cb0371bbc0355478d8-0 0\r
Found 1 valid and 0 broken data file(s)
Checksum(s) with data: 1
 -> 59ca0efa9f5633cb0371bbc0355478d8-0, 0
Obsolete checksum(s): 1
Backup::removeHash(59ca0efa9f5633cb0371bbc0355478d8-0)
 -> removed data for 59ca0efa9f5633cb0371bbc0355478d8-0
Database closed
Database open in read/write mode
Sorting list
List contains 0 checksum(s)
List contains 0 unique checksum(s)
Crawling through DB
Found 0 valid and 0 broken data file(s)
File data corrupted, thorough scan
Database closed
Database open in read-only mode
Crawling through DB data
Error: Data corrupted for 59ca0efa9f5633cb0371bbc0355478d8-0
Checksum: d41d8cd98f00b204e9800998ecf8427e
Reported corruption for 59ca0efa9f5633cb0371bbc0355478d8-0
Found 0 valid and 1 broken data file(s)
Database closed
Database open in read/write mode
Sorting list
List contains 0 checksum(s)
List contains 0 unique checksum(s)
Crawling through DB
Backup::removeHash(59ca0efa9f5633cb0371bbc0355478d8-0)
Removed corrupted data for 59ca0efa9f5633cb0371bbc0355478d8-0
Found 0 valid and 1 broken data file(s)
Scan again
Database closed

Test: lock
Database open in read/write mode
Database closed
Warning: Database lock reset
Database open in read/write mode
Database closed
Error: Database lock taken by process with pid 1
Error: Database lock taken by an unidentified process!
Error: Permission denied trying to lock database
Error: Database lock taken by an unidentified process!

Test: read-only mode
Database open in read-only mode
Database closed

Test: fill in DB
Database open in read/write mode
Reading list of problematic checksums
Register created for 'myClient'
Database open r/w for 'myClient'
Adding compressed data for 285b35198a5e188b3a0df3ed33f93a26-0
Backup::addHash(285b35198a5e188b3a0df3ed33f93a26)
Replacing with uncompressed data for 285b35198a5e188b3a0df3ed33f93a26-0
Backup::addHash(285b35198a5e188b3a0df3ed33f93a26)
Adding uncompressed data for d41d8cd98f00b204e9800998ecf8427e-0
Backup::addHash(d41d8cd98f00b204e9800998ecf8427e)
Adding uncompressed data for 59ca0efa9f5633cb0371bbc0355478d8-0
Backup::addHash(59ca0efa9f5633cb0371bbc0355478d8)
Adding uncompressed data for 3d546a1ce46c6ae10ad34ab8a81c542e-0
Backup::addHash(3d546a1ce46c6ae10ad34ab8a81c542e)
Register modified for 'myClient'
Database closed for 'myClient'
Backup::add(test_db/myClient)
Database closed
[ 1] /client_path/subdir            d        0 755
[ 2] /client_path/subdir/testfile   f       12 644 285b35198a5e188b3a0df3ed33f93a26-0
[ 3] /client_path/subdir/testfile2  f       12 644 285b35198a5e188b3a0df3ed33f93a26-0
[ 4] /client_path/test space        f        0 644 d41d8cd98f00b204e9800998ecf8427e-0
[ 5] /client_path/testfile          f       13 750 59ca0efa9f5633cb0371bbc0355478d8-0
[ 6] other_path/testdir             d        0 755
[ 7] other_path/testfile            f   145408 644 3d546a1ce46c6ae10ad34ab8a81c542e-0

Test: do nothing
Database open in read/write mode
Database closed
[ 1] /client_path/subdir            d        0 755
[ 2] /client_path/subdir/testfile   f       12 644 285b35198a5e188b3a0df3ed33f93a26-0
[ 3] /client_path/subdir/testfile2  f       12 644 285b35198a5e188b3a0df3ed33f93a26-0
[ 4] /client_path/test space        f        0 644 d41d8cd98f00b204e9800998ecf8427e-0
[ 5] /client_path/testfile          f       13 750 59ca0efa9f5633cb0371bbc0355478d8-0
[ 6] other_path/testdir             d        0 755
[ 7] other_path/testfile            f   145408 644 3d546a1ce46c6ae10ad34ab8a81c542e-0

Test: read clients
Database open in read-only mode
Database closed
List of clients: 1
 -> myClient

Test: read paths in myClient
Database open in read-only mode
Database open r-o for 'myClient'
Database closed for 'myClient'
List of paths: 2
 -> /client_path/
 -> other_path/

Test: read paths in myClient below /client_path
Database open r-o for 'myClient'
Database closed for 'myClient'
List of paths: 3
 -> /client_path/subdir/
 -> /client_path/test space
 -> /client_path/testfile

Test: read paths in myClient below other_path
Database open r-o for 'myClient'
Database closed for 'myClient'
List of paths: 2
 -> other_path/testdir/
 -> other_path/testfile

Test: read paths in myClient below /client_path/subdir
Database open r-o for 'myClient'
Database closed for 'myClient'
List of paths: 2
 -> /client_path/subdir/testfile
 -> /client_path/subdir/testfile2
Database closed

Test: scan
Database open in read/write mode
Reading list for 'myClient'
Sorting list
List contains 5 checksum(s)
List contains 4 unique checksum(s)
Crawling through DB
285b35198a5e188b3a0df3ed33f93a26-0 12\r
Error: Data missing for 3d546a1ce46c6ae10ad34ab8a81c542e-0
Backup::removeHash(3d546a1ce46c6ae10ad34ab8a81c542e-0)
59ca0efa9f5633cb0371bbc0355478d8-0 13\r
6d7fce9fee471194aa8b5b6e47267f03-0 2 \r
d41d8cd98f00b204e9800998ecf8427e-0 0\r
Found 4 valid and 1 broken data file(s)
Checksum(s) from list: 4
 -> 285b35198a5e188b3a0df3ed33f93a26-0, 12
 -> 3d546a1ce46c6ae10ad34ab8a81c542e-0, 145408
 -> 59ca0efa9f5633cb0371bbc0355478d8-0, 13
 -> d41d8cd98f00b204e9800998ecf8427e-0, 0
Checksum(s) with data: 4
 -> 285b35198a5e188b3a0df3ed33f93a26-0, 12
 -> 59ca0efa9f5633cb0371bbc0355478d8-0, 13
 -> 6d7fce9fee471194aa8b5b6e47267f03-0, 2
 -> d41d8cd98f00b204e9800998ecf8427e-0, 0
Obsolete checksum(s): 1
Backup::removeHash(6d7fce9fee471194aa8b5b6e47267f03-0)
 -> removed data for 6d7fce9fee471194aa8b5b6e47267f03-0
Warning: Problematic checksum(s): 1
 -> 3d546a1ce46c6ae10ad34ab8a81c542e-0 missing
Backup::add(test_db/.checksums)
Missing checksums list updated
List of problematic checksums contains 1 item
Database closed

Test: concurrent access
Database open in read/write mode
Backup::Backup(test_db/.backup)
Database open in read-only mode
Database open r-o for 'myClient'
Reading list of problematic checksums
 -> Missing 3d546a1ce46c6ae10ad34ab8a81c542e-0
Database open r/w for 'myClient'
D       /client_path/subdir
D       /client_path/subdir/testfile
D       /client_path/subdir/testfile2
D       /client_path/test space
D       /client_path/testfile
D       other_path/testdir
D       other_path/testfile
Register modified for 'myClient'
Database closed for 'myClient'
Backup::add(test_db/myClient)
Database closed for 'myClient'
Database closed
List of problematic checksums contains 1 item
Database closed
[ 8] /client_path/new_link          l        8 777 testfile
[ 8] /client_path/subdir            [rm]
[ 8] /client_path/subdir/testfile   [rm]
[ 8] /client_path/subdir/testfile2  [rm]
[ 8] /client_path/test space        [rm]
[ 8] /client_path/testfile          [rm]
[ 8] other_path/testdir             [rm]
[ 8] other_path/testfile            [rm]
List of paths: 3
 -> /client_path/subdir/
 -> /client_path/test space
 -> /client_path/testfile
Database open in read-only mode
Database open r-o for 'myClient'
Database closed for 'myClient'
Database closed
List of paths: 3
 -> /client_path/subdir/
 -> /client_path/test space
 -> /client_path/testfile
Date: 0
Database open in read-only mode
Database open r-o for 'myClient'
Database closed for 'myClient'
Database closed
List of paths: 3
 -> /client_path/subdir/
 -> /client_path/test space
 -> /client_path/testfile
Date: -4 from 8
Database open in read-only mode
Database open r-o for 'myClient'
Database closed for 'myClient'
Database closed
List of paths: 2
 -> /client_path/subdir/
 -> /client_path/test space
Date: 3
Database open in read-only mode
Database open r-o for 'myClient'
Database closed for 'myClient'
Database closed
List of paths: 1
 -> /client_path/subdir/
